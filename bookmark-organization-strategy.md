# ä¹¦ç­¾æ•´ç†ç­–ç•¥æ–¹æ¡ˆ - è§£å†³å¤§è§„æ¨¡ä¹¦ç­¾åˆ†ç±»é—®é¢˜

## é—®é¢˜åˆ†æ

**ç°çŠ¶**ï¼š400+ä¹¦ç­¾éœ€è¦æ•´ç†

**æ–¹æ¡ˆ1çš„é—®é¢˜**ï¼š
- âŒ ä¸€æ¬¡æ€§å‘é€æ‰€æœ‰ä¹¦ç­¾ç»™AI
- âŒ åˆ†ç±»ä¸å¤Ÿç²¾ç¡®ï¼Œå¾ˆå¤šä¹¦ç­¾è¢«å½’å…¥"å…¶ä»–"ç±»åˆ«
- âŒ Tokené™åˆ¶å¯èƒ½å¯¼è‡´è¯·æ±‚å¤±è´¥

**æ–¹æ¡ˆ2çš„é—®é¢˜**ï¼š
- âŒ æ¯æ¬¡25ä¸ªï¼Œéœ€è¦å¤šæ¬¡äº¤äº’ï¼ˆ400Ã·25â‰ˆ16æ¬¡ï¼‰
- âŒ åªæœ‰ä¸€çº§åˆ†ç±»ï¼Œæ— æ³•æ„å»ºå±‚çº§ç»“æ„
- âŒ å„æ‰¹æ¬¡ä¹‹é—´çš„åˆ†ç±»ä¸ä¸€è‡´ï¼Œéš¾ä»¥åˆå¹¶

---

## ğŸ¯ æ¨èæ–¹æ¡ˆï¼šä¸‰é˜¶æ®µåˆ†å±‚æ•´ç†æ³•

### æ ¸å¿ƒæ€è·¯
**å…ˆæ•´ä½“è§„åˆ’ï¼Œå†åˆ†æ‰¹ç»†åŒ–ï¼Œæœ€ååˆå¹¶ä¼˜åŒ–**

---

## é˜¶æ®µ1ï¼šå…¨å±€åˆ†ç±»è§„åˆ’ï¼ˆ1æ¬¡APIè°ƒç”¨ï¼‰

### ç›®æ ‡
è®©AIç†è§£ä½ çš„400ä¸ªä¹¦ç­¾çš„æ•´ä½“ç»“æ„ï¼Œè§„åˆ’é¡¶å±‚åˆ†ç±»ä½“ç³»

### æ“ä½œæ­¥éª¤
1. **æå–ä¹¦ç­¾æ‘˜è¦**
   - åªå‘é€ï¼šä¹¦ç­¾æ ‡é¢˜ + URLåŸŸåï¼ˆä¸å‘é€å®Œæ•´URLï¼‰
   - å‹ç¼©æ•°æ®é‡ï¼Œ400ä¸ªä¹¦ç­¾çº¦å ç”¨è¾ƒå°‘tokens

2. **AIä»»åŠ¡**
   ```
   åˆ†æè¿™400ä¸ªä¹¦ç­¾ï¼Œåˆ›å»ºä¸€ä¸ª2-3å±‚çš„åˆ†ç±»ä½“ç³»ï¼š
   
   è¾“å…¥ç¤ºä¾‹ï¼š
   - GitHub (github.com)
   - Vueæ–‡æ¡£ (vuejs.org)
   - Reactæ–‡æ¡£ (react.dev)
   - é˜®ä¸€å³°åšå®¢ (ruanyifeng.com)
   - Pythonæ•™ç¨‹ (python.org)
   - æ·˜å® (taobao.com)
   - äº¬ä¸œ (jd.com)
   ...
   
   è¾“å‡ºè¦æ±‚ï¼š
   1. è¯†åˆ«ä¸»è¦ç±»åˆ«ï¼ˆå¦‚ï¼šå¼€å‘ã€å­¦ä¹ ã€è´­ç‰©ã€å¨±ä¹ç­‰ï¼‰
   2. æ¯ä¸ªä¸»ç±»åˆ«ä¸‹è®¾2-4ä¸ªå­ç±»åˆ«
   3. ä¼°ç®—æ¯ä¸ªç±»åˆ«çš„ä¹¦ç­¾æ•°é‡
   4. è¿”å›å®Œæ•´çš„åˆ†ç±»æ ‘ç»“æ„
   ```

3. **é¢„æœŸè¾“å‡º**
   ```json
   {
     "classification_tree": {
       "ğŸ’¼ å·¥ä½œå­¦ä¹ ": {
         "description": "ç¼–ç¨‹å’ŒæŠ€æœ¯å­¦ä¹ ç›¸å…³",
         "subcategories": {
           "å‰ç«¯å¼€å‘": ["React", "Vue", "JavaScriptç›¸å…³"],
           "åç«¯å¼€å‘": ["Python", "Node.js", "æ•°æ®åº“"],
           "å¼€å‘å·¥å…·": ["GitHub", "GitLab", "CI/CD"],
           "æŠ€æœ¯æ–‡æ¡£": ["å®˜æ–¹æ–‡æ¡£", "APIå‚è€ƒ", "æ•™ç¨‹"]
         },
         "estimated_count": 150
       },
       "ğŸ›’ ç”Ÿæ´»è´­ç‰©": {
         "subcategories": {
           "ç”µå•†å¹³å°": [],
           "ä¼˜æƒ æ¯”ä»·": []
         },
         "estimated_count": 50
       },
       "ğŸ“° æ–°é—»èµ„è®¯": {...},
       "ğŸ® å¨±ä¹ä¼‘é—²": {...}
     }
   }
   ```

**ä¼˜åŠ¿**ï¼š
- âœ… ä¸€æ¬¡æ€§ç†è§£å…¨å±€
- âœ… æ„å»ºå±‚çº§åˆ†ç±»ä½“ç³»
- âœ… ä¸ºåç»­åˆ†æ‰¹å¤„ç†æä¾›ç»Ÿä¸€æ¡†æ¶

---

## é˜¶æ®µ2ï¼šåˆ†æ‰¹ç²¾ç»†æ•´ç†ï¼ˆå¤šæ¬¡APIè°ƒç”¨ï¼‰

### ç›®æ ‡
åœ¨å…¨å±€åˆ†ç±»æ¡†æ¶ä¸‹ï¼Œåˆ†æ‰¹å¤„ç†ä¹¦ç­¾ï¼Œç²¾ç¡®å½’ç±»

### æ“ä½œæ­¥éª¤
1. **æ™ºèƒ½åˆ†æ‰¹ç­–ç•¥**
   - ä¸æ˜¯ç®€å•çš„25ä¸ªä¸€æ‰¹
   - æŒ‰ç…§é˜¶æ®µ1çš„åˆ†ç±»ï¼Œå°†ç›¸ä¼¼ä¹¦ç­¾åˆ†åˆ°ä¸€æ‰¹
   - ä¾‹å¦‚ï¼šæŠŠæ‰€æœ‰ç–‘ä¼¼"å‰ç«¯å¼€å‘"çš„ä¹¦ç­¾ï¼ˆçº¦40ä¸ªï¼‰ä½œä¸ºä¸€æ‰¹

2. **AIä»»åŠ¡ï¼ˆæ¯æ‰¹ï¼‰**
   ```
   å…¨å±€åˆ†ç±»ä½“ç³»ï¼š[é˜¶æ®µ1çš„åˆ†ç±»æ ‘]
   
   å½“å‰æ‰¹æ¬¡ä¹¦ç­¾ï¼ˆå®Œæ•´ä¿¡æ¯ï¼‰ï¼š
   - GitHub - ä»£ç æ‰˜ç®¡ (https://github.com)
   - Vue.jså®˜æ–¹æ–‡æ¡£ (https://vuejs.org)
   ...
   
   ä»»åŠ¡ï¼š
   1. å°†æ¯ä¸ªä¹¦ç­¾ç²¾ç¡®å½’ç±»åˆ°å…¨å±€åˆ†ç±»ä½“ç³»ä¸­
   2. å¦‚æœæ ‡é¢˜ä¸å¤Ÿæè¿°æ€§ï¼Œæä¾›æ›´å¥½çš„æ ‡é¢˜
   3. å¦‚æœå‘ç°é‡å¤ï¼Œæ ‡è®°å‡ºæ¥
   4. å¦‚æœæŸä¸ªä¹¦ç­¾ä¸é€‚åˆä»»ä½•ç°æœ‰åˆ†ç±»ï¼Œå»ºè®®æ–°å»ºå­åˆ†ç±»
   ```

3. **æ‰¹æ¬¡è§„åˆ’ç¤ºä¾‹**
   ```
   æ‰¹æ¬¡1ï¼ˆ45ä¸ªï¼‰ï¼šå‰ç«¯å¼€å‘ç›¸å…³ â†’ å½’ç±»åˆ°"å·¥ä½œå­¦ä¹ /å‰ç«¯å¼€å‘"
   æ‰¹æ¬¡2ï¼ˆ38ä¸ªï¼‰ï¼šåç«¯å¼€å‘ç›¸å…³ â†’ å½’ç±»åˆ°"å·¥ä½œå­¦ä¹ /åç«¯å¼€å‘"
   æ‰¹æ¬¡3ï¼ˆ30ä¸ªï¼‰ï¼šå¼€å‘å·¥å…·ç›¸å…³ â†’ å½’ç±»åˆ°"å·¥ä½œå­¦ä¹ /å¼€å‘å·¥å…·"
   æ‰¹æ¬¡4ï¼ˆ50ä¸ªï¼‰ï¼šè´­ç‰©ç›¸å…³ â†’ å½’ç±»åˆ°"ç”Ÿæ´»è´­ç‰©/*"
   ...
   æ‰¹æ¬¡10ï¼ˆ25ä¸ªï¼‰ï¼šæ— æ³•è‡ªåŠ¨åˆ†ç±»çš„ â†’ AIå»ºè®®æ–°åˆ†ç±»
   ```

**ä¼˜åŠ¿**ï¼š
- âœ… æ¯æ‰¹ä¹¦ç­¾ä¸»é¢˜ç›¸è¿‘ï¼Œåˆ†ç±»æ›´ç²¾ç¡®
- âœ… åœ¨ç»Ÿä¸€æ¡†æ¶ä¸‹ï¼Œé¿å…åˆ†ç±»å†²çª
- âœ… å¯ä»¥é€æ­¥ä¼˜åŒ–åˆ†ç±»ä½“ç³»

---

## é˜¶æ®µ3ï¼šåˆå¹¶ä¼˜åŒ–ï¼ˆ1æ¬¡APIè°ƒç”¨ï¼Œå¯é€‰ï¼‰

### ç›®æ ‡
å®¡æŸ¥æ•´ç†ç»“æœï¼Œä¼˜åŒ–åˆ†ç±»ç»“æ„

### æ“ä½œæ­¥éª¤
1. **æ±‡æ€»æ‰€æœ‰æ‰¹æ¬¡ç»“æœ**
2. **AIä»»åŠ¡**
   ```
   ç»è¿‡åˆ†æ‰¹æ•´ç†ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š
   - å·¥ä½œå­¦ä¹ /å‰ç«¯å¼€å‘ï¼š45ä¸ªä¹¦ç­¾
   - å·¥ä½œå­¦ä¹ /åç«¯å¼€å‘ï¼š38ä¸ªä¹¦ç­¾
   - å·¥ä½œå­¦ä¹ /å¼€å‘å·¥å…·ï¼š30ä¸ªä¹¦ç­¾
   ...
   
   é—®é¢˜ï¼š
   1. æ˜¯å¦æœ‰åˆ†ç±»è¿‡ç»†æˆ–è¿‡ç²—çš„æƒ…å†µï¼Ÿ
   2. æ˜¯å¦æœ‰éœ€è¦åˆå¹¶çš„å­åˆ†ç±»ï¼Ÿ
   3. æ˜¯å¦æœ‰ä¹¦ç­¾è¢«é”™è¯¯åˆ†ç±»ï¼Ÿ
   
   è¯·æä¾›ä¼˜åŒ–å»ºè®®ã€‚
   ```

**ä¼˜åŠ¿**ï¼š
- âœ… å…¨å±€å®¡è§†ï¼Œå‘ç°é—®é¢˜
- âœ… ä¼˜åŒ–åˆ†ç±»ç»“æ„
- âœ… æå‡æ•´ä½“è´¨é‡

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| ç»´åº¦ | æ–¹æ¡ˆ1ï¼ˆå…¨é‡ï¼‰ | æ–¹æ¡ˆ2ï¼ˆå°æ‰¹æ¬¡ï¼‰ | æ¨èæ–¹æ¡ˆï¼ˆä¸‰é˜¶æ®µï¼‰ |
|------|-------------|----------------|------------------|
| **åˆ†ç±»ç²¾ç¡®åº¦** | â­â­ ä¸å¤Ÿç²¾ç¡® | â­â­â­ è¾ƒç²¾ç¡® | â­â­â­â­â­ éå¸¸ç²¾ç¡® |
| **å±‚çº§ç»“æ„** | â­â­â­ æœ‰å±‚çº§ | â­ æ— å±‚çº§ | â­â­â­â­â­ å®Œæ•´å±‚çº§ |
| **APIè°ƒç”¨æ¬¡æ•°** | 1æ¬¡ | 16æ¬¡ | 8-12æ¬¡ |
| **åˆ†ç±»ä¸€è‡´æ€§** | â­â­â­ ä¸€è‡´ | â­â­ ä¸ä¸€è‡´ | â­â­â­â­â­ éå¸¸ä¸€è‡´ |
| **Tokenæ¶ˆè€—** | é«˜ï¼ˆå¯èƒ½è¶…é™ï¼‰ | ä½ | ä¸­ç­‰ |
| **äººå·¥å¹²é¢„** | å¤šï¼ˆéœ€æ‰‹åŠ¨è°ƒæ•´"å…¶ä»–"ç±»ï¼‰ | å¤šï¼ˆéœ€æ‰‹åŠ¨åˆå¹¶ï¼‰ | å°‘ï¼ˆæ¡†æ¶æ˜ç¡®ï¼‰ |

---

## ğŸ› ï¸ å…·ä½“å®ç°æ–¹æ¡ˆ

### å®ç°æ¶æ„

```javascript
class ThreeStageOrganizer {
  constructor(bookmarks, aiProvider) {
    this.bookmarks = bookmarks;
    this.aiProvider = aiProvider;
    this.classificationTree = null;
    this.batches = [];
  }
  
  // é˜¶æ®µ1ï¼šå…¨å±€è§„åˆ’
  async planGlobalStructure() {
    const summary = this.bookmarks.map(b => ({
      title: b.title,
      domain: new URL(b.url).hostname
    }));
    
    const prompt = `
      åˆ†æä»¥ä¸‹${this.bookmarks.length}ä¸ªä¹¦ç­¾çš„æ‘˜è¦ï¼Œ
      åˆ›å»ºä¸€ä¸ª2-3å±‚çš„åˆ†ç±»ä½“ç³»...
    `;
    
    this.classificationTree = await this.aiProvider.organize(summary, prompt);
    return this.classificationTree;
  }
  
  // é˜¶æ®µ2ï¼šæ™ºèƒ½åˆ†æ‰¹
  async createSmartBatches() {
    // æ ¹æ®åˆ†ç±»æ ‘å’Œä¹¦ç­¾ç›¸ä¼¼åº¦ï¼Œæ™ºèƒ½åˆ†æ‰¹
    this.batches = this.groupBySimilarity(
      this.bookmarks, 
      this.classificationTree,
      30 // æ¯æ‰¹30-40ä¸ª
    );
  }
  
  // é˜¶æ®µ2ï¼šåˆ†æ‰¹å¤„ç†
  async processBatches(onProgress) {
    const results = [];
    
    for (let i = 0; i < this.batches.length; i++) {
      const batch = this.batches[i];
      const prompt = this.buildBatchPrompt(batch, this.classificationTree);
      const result = await this.aiProvider.organize(batch, prompt);
      
      results.push(result);
      onProgress((i + 1) / this.batches.length * 100);
      
      // é¿å…APIé™æµ
      await this.sleep(2000);
    }
    
    return results;
  }
  
  // é˜¶æ®µ3ï¼šåˆå¹¶ä¼˜åŒ–
  async optimizeResults(batchResults) {
    const merged = this.mergeBatchResults(batchResults);
    const prompt = `å®¡æŸ¥æ•´ç†ç»“æœï¼Œæä¾›ä¼˜åŒ–å»ºè®®...`;
    
    return await this.aiProvider.optimize(merged, prompt);
  }
  
  // è¾…åŠ©ï¼šæ™ºèƒ½åˆ†ç»„
  groupBySimilarity(bookmarks, tree, batchSize) {
    // 1. æ ¹æ®åŸŸåç›¸ä¼¼åº¦é¢„åˆ†ç»„
    const domainGroups = this.groupByDomain(bookmarks);
    
    // 2. æ ¹æ®åˆ†ç±»æ ‘çš„é¢„ä¼°ï¼Œå°†ç›¸ä¼¼ç»„åˆå¹¶æˆæ‰¹æ¬¡
    const batches = [];
    let currentBatch = [];
    
    for (const group of domainGroups) {
      if (currentBatch.length + group.length <= batchSize) {
        currentBatch.push(...group);
      } else {
        if (currentBatch.length > 0) {
          batches.push(currentBatch);
        }
        currentBatch = [...group];
      }
    }
    
    if (currentBatch.length > 0) {
      batches.push(currentBatch);
    }
    
    return batches;
  }
  
  // è¾…åŠ©ï¼šåŸŸååˆ†ç»„
  groupByDomain(bookmarks) {
    const groups = {};
    
    for (const bookmark of bookmarks) {
      const domain = new URL(bookmark.url).hostname;
      if (!groups[domain]) {
        groups[domain] = [];
      }
      groups[domain].push(bookmark);
    }
    
    return Object.values(groups);
  }
}
```

---

## ğŸ“ Promptæ¨¡æ¿

### é˜¶æ®µ1 Prompt

```javascript
const STAGE1_PROMPT = `
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¿¡æ¯æ¶æ„å¸ˆã€‚æˆ‘æœ‰ ${bookmarkCount} ä¸ªæµè§ˆå™¨ä¹¦ç­¾éœ€è¦æ•´ç†ã€‚

ä»¥ä¸‹æ˜¯æ‰€æœ‰ä¹¦ç­¾çš„æ‘˜è¦ï¼ˆæ ‡é¢˜ + åŸŸåï¼‰ï¼š
${bookmarkSummary}

è¯·å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š

1. **åˆ†æä¸»é¢˜åˆ†å¸ƒ**
   - è¯†åˆ«ä¸»è¦ç±»åˆ«ï¼ˆå»ºè®®4-8ä¸ªé¡¶çº§åˆ†ç±»ï¼‰
   - æ¯ä¸ªç±»åˆ«åº”è¯¥æœ‰æ˜ç¡®çš„ä¸»é¢˜

2. **æ„å»ºå±‚çº§ç»“æ„**
   - é¡¶å±‚ï¼šä¸»è¦ç±»åˆ«ï¼ˆå¦‚ï¼šå·¥ä½œã€å­¦ä¹ ã€ç”Ÿæ´»ã€å¨±ä¹ï¼‰
   - ç¬¬äºŒå±‚ï¼šå…·ä½“å­åˆ†ç±»ï¼ˆæ¯ä¸ªé¡¶å±‚åˆ†ç±»ä¸‹2-5ä¸ªå­åˆ†ç±»ï¼‰
   - ç¬¬ä¸‰å±‚ï¼šå¯é€‰çš„ç»†åˆ†ï¼ˆä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ï¼‰

3. **ä¼°ç®—åˆ†å¸ƒ**
   - ä¼°ç®—æ¯ä¸ªåˆ†ç±»ä¸‹çš„ä¹¦ç­¾æ•°é‡
   - æ ‡æ³¨å“ªäº›åˆ†ç±»å¯èƒ½éœ€è¦è¿›ä¸€æ­¥ç»†åˆ†

4. **è¿”å›JSONæ ¼å¼**
{
  "categories": [
    {
      "name": "ğŸ’¼ å·¥ä½œå­¦ä¹ ",
      "description": "ç¼–ç¨‹ã€æŠ€æœ¯ã€èŒä¸šå‘å±•ç›¸å…³",
      "subcategories": [
        {
          "name": "å‰ç«¯å¼€å‘",
          "tags": ["React", "Vue", "JavaScript", "CSS"],
          "estimated_count": 45
        },
        {
          "name": "åç«¯å¼€å‘",
          "tags": ["Python", "Node.js", "æ•°æ®åº“"],
          "estimated_count": 38
        }
      ],
      "total_estimated": 150
    },
    ...
  ],
  "total_bookmarks": ${bookmarkCount},
  "recommended_batches": 10,
  "notes": "é¢å¤–å»ºè®®å’Œè¯´æ˜"
}

è¦æ±‚ï¼š
- åˆ†ç±»åç§°ç®€æ´æ¸…æ™°ï¼ˆå»ºè®®åŠ emojiï¼‰
- é¿å…"å…¶ä»–"ã€"æ‚é¡¹"ç­‰æ¨¡ç³Šåˆ†ç±»
- å­åˆ†ç±»ä¹‹é—´ä¸åº”è¯¥æœ‰é‡å 
- ä¼°ç®—è¦åˆç†
`;
```

### é˜¶æ®µ2 Prompt

```javascript
const STAGE2_PROMPT = `
å…¨å±€åˆ†ç±»ä½“ç³»ï¼ˆæ¥è‡ªé˜¶æ®µ1ï¼‰ï¼š
${JSON.stringify(classificationTree, null, 2)}

å½“å‰æ‰¹æ¬¡ï¼šç¬¬ ${currentBatch}/${totalBatches} æ‰¹
é¢„æœŸä¸»é¢˜ï¼š${expectedTheme}

ä¹¦ç­¾åˆ—è¡¨ï¼ˆ${batchSize}ä¸ªï¼‰ï¼š
${JSON.stringify(bookmarks, null, 2)}

ä»»åŠ¡ï¼š
1. å°†æ¯ä¸ªä¹¦ç­¾ç²¾ç¡®å½’ç±»åˆ°å…¨å±€åˆ†ç±»ä½“ç³»ä¸­
2. æ ¼å¼ï¼šcategories > subcategory > ä¹¦ç­¾
3. å¦‚æœæ ‡é¢˜ä¸å¤Ÿæè¿°æ€§ï¼Œæä¾›æ”¹è¿›çš„æ ‡é¢˜
4. å¦‚æœå‘ç°é‡å¤ä¹¦ç­¾ï¼Œæ ‡è®°å‡ºæ¥
5. å¦‚æœæŸä¹¦ç­¾ä¸é€‚åˆç°æœ‰åˆ†ç±»ï¼Œå»ºè®®åœ¨å“ªä¸ªcategoryä¸‹æ–°å»ºsubcategory

è¿”å›JSONæ ¼å¼ï¼š
{
  "batch_id": ${currentBatch},
  "classifications": [
    {
      "bookmark_id": "123",
      "original_title": "GitHub",
      "suggested_title": "GitHub - ä»£ç æ‰˜ç®¡ä¸åä½œå¹³å°",
      "category": "ğŸ’¼ å·¥ä½œå­¦ä¹ ",
      "subcategory": "å¼€å‘å·¥å…·",
      "confidence": 0.95,
      "reason": "ä»£ç æ‰˜ç®¡å¹³å°ï¼Œå±äºå¼€å‘å·¥å…·"
    },
    ...
  ],
  "duplicates": [
    {"id1": "123", "id2": "456", "reason": "ç›¸åŒURL"}
  ],
  "new_subcategory_suggestions": [
    {
      "parent_category": "ğŸ’¼ å·¥ä½œå­¦ä¹ ",
      "new_subcategory": "DevOpså·¥å…·",
      "reason": "å‘ç°å¤šä¸ªCI/CDã€å®¹å™¨åŒ–å·¥å…·ï¼Œå»ºè®®ç‹¬ç«‹åˆ†ç±»",
      "bookmark_ids": ["789", "790"]
    }
  ],
  "uncertain_classifications": [
    {
      "bookmark_id": "999",
      "possible_categories": ["category1", "category2"],
      "note": "å¯èƒ½å±äºå¤šä¸ªåˆ†ç±»ï¼Œå»ºè®®äººå·¥ç¡®è®¤"
    }
  ]
}

è¦æ±‚ï¼š
- ä¸¥æ ¼éµå¾ªå…¨å±€åˆ†ç±»ä½“ç³»
- æä¾›åˆ†ç±»ç†ç”±ï¼Œå¢å¼ºå¯è§£é‡Šæ€§
- confidence > 0.8 æ‰è‡ªåŠ¨å½’ç±»ï¼Œå¦åˆ™æ ‡è®°ä¸ºuncertain
- ç§¯æå‘ç°é‡å¤å’Œé—®é¢˜
`;
```

### é˜¶æ®µ3 Prompt

```javascript
const STAGE3_PROMPT = `
ç»è¿‡åˆ†æ‰¹æ•´ç†ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š

å…¨å±€åˆ†ç±»æ ‘ï¼š
${JSON.stringify(classificationTree, null, 2)}

å„æ‰¹æ¬¡æ•´ç†æ±‡æ€»ï¼š
${JSON.stringify(batchSummary, null, 2)}

å‘ç°çš„é—®é¢˜ï¼š
- ${duplicateCount} ä¸ªé‡å¤ä¹¦ç­¾
- ${uncertainCount} ä¸ªä¸ç¡®å®šåˆ†ç±»
- ${newSubcategoryCount} ä¸ªæ–°å­åˆ†ç±»å»ºè®®

è¯·å®¡æŸ¥å¹¶ä¼˜åŒ–ï¼š

1. **ç»“æ„ä¼˜åŒ–**
   - æ˜¯å¦æœ‰åˆ†ç±»è¿‡ç»†ï¼ˆ<5ä¸ªä¹¦ç­¾ï¼‰éœ€è¦åˆå¹¶ï¼Ÿ
   - æ˜¯å¦æœ‰åˆ†ç±»è¿‡ç²—ï¼ˆ>50ä¸ªä¹¦ç­¾ï¼‰éœ€è¦æ‹†åˆ†ï¼Ÿ
   - å±‚çº§æ˜¯å¦åˆç†ï¼ˆå»ºè®®2-3å±‚ï¼‰ï¼Ÿ

2. **ä¸€è‡´æ€§æ£€æŸ¥**
   - ä¸åŒæ‰¹æ¬¡çš„åˆ†ç±»æ˜¯å¦ä¸€è‡´ï¼Ÿ
   - å‘½åæ˜¯å¦ç»Ÿä¸€ï¼Ÿ
   - æ˜¯å¦æœ‰é‡å çš„åˆ†ç±»ï¼Ÿ

3. **è´¨é‡è¯„ä¼°**
   - æ ‡é¢˜æ”¹è¿›æ˜¯å¦åˆé€‚ï¼Ÿ
   - åˆ†ç±»æ˜¯å¦è¯­ä¹‰æ¸…æ™°ï¼Ÿ
   - ç”¨æˆ·å‹å¥½åº¦å¦‚ä½•ï¼Ÿ

è¿”å›ä¼˜åŒ–æ–¹æ¡ˆï¼š
{
  "optimizations": [
    {
      "type": "merge_subcategories",
      "action": "åˆå¹¶'å‰ç«¯æ¡†æ¶'å’Œ'å‰ç«¯åº“'ä¸º'å‰ç«¯æŠ€æœ¯'",
      "reason": "ä¸¤è€…åŒºåˆ†ä¸æ˜æ˜¾ï¼Œåˆå¹¶æ›´æ¸…æ™°",
      "affected_bookmarks": 23
    },
    {
      "type": "split_category",
      "action": "å°†'å­¦ä¹ èµ„æº'æ‹†åˆ†ä¸º'åœ¨çº¿è¯¾ç¨‹'å’Œ'æŠ€æœ¯åšå®¢'",
      "reason": "å­¦ä¹ èµ„æºè¿‡å¤š(78ä¸ª)ï¼Œç»†åˆ†æ›´å¥½ç®¡ç†"
    },
    {
      "type": "rename",
      "old_name": "å·¥å…·",
      "new_name": "å¼€å‘å·¥å…·",
      "reason": "æ›´å…·ä½“æ˜ç¡®"
    }
  ],
  "final_structure": {
    // ä¼˜åŒ–åçš„å®Œæ•´åˆ†ç±»æ ‘
  },
  "statistics": {
    "total_categories": 6,
    "total_subcategories": 24,
    "avg_bookmarks_per_subcategory": 16.7,
    "depth": 2
  },
  "quality_score": 0.92,
  "recommendations": [
    "å»ºè®®å®šæœŸæ¸…ç†é‡å¤ä¹¦ç­¾",
    "è€ƒè™‘ä¸ºå¸¸ç”¨ç½‘ç«™æ·»åŠ æ˜Ÿæ ‡"
  ]
}
`;
```

---

## ğŸ’¡ è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### ä¼˜åŒ–1ï¼šé¢„åˆ†ç±»è¿‡æ»¤
åœ¨é˜¶æ®µ1ä¹‹å‰ï¼Œå…ˆåšç®€å•çš„è‡ªåŠ¨åˆ†ç±»ï¼š

```javascript
function preClassify(bookmarks) {
  const categories = {
    shopping: [],
    social: [],
    dev: [],
    news: [],
    other: []
  };
  
  const patterns = {
    shopping: ['taobao', 'jd.com', 'amazon', 'tmall'],
    social: ['twitter', 'facebook', 'weibo', 'zhihu'],
    dev: ['github', 'stackoverflow', 'mdn', 'npmjs'],
    news: ['news', 'blog', 'medium']
  };
  
  for (const bookmark of bookmarks) {
    const domain = new URL(bookmark.url).hostname;
    let classified = false;
    
    for (const [category, keywords] of Object.entries(patterns)) {
      if (keywords.some(kw => domain.includes(kw))) {
        categories[category].push(bookmark);
        classified = true;
        break;
      }
    }
    
    if (!classified) {
      categories.other.push(bookmark);
    }
  }
  
  return categories;
}
```

è¿™æ ·å¯ä»¥å°†æ˜æ˜¾çš„ä¹¦ç­¾å…ˆåˆ†ç±»ï¼Œå‡å°‘AIçš„å·¥ä½œé‡ã€‚

### ä¼˜åŒ–2ï¼šæ¸è¿›å¼ç¡®è®¤
ä¸è¦ç­‰æ‰€æœ‰æ‰¹æ¬¡éƒ½å¤„ç†å®Œï¼Œè€Œæ˜¯ï¼š
1. å¤„ç†ç¬¬1æ‰¹åï¼Œç«‹å³å±•ç¤ºç»“æœ
2. ç”¨æˆ·ç¡®è®¤ç¬¬1æ‰¹åˆ†ç±»åˆç†
3. ç»§ç»­å¤„ç†åç»­æ‰¹æ¬¡
4. å¦‚æœå‘ç°é—®é¢˜ï¼ŒåŠæ—¶è°ƒæ•´ç­–ç•¥

### ä¼˜åŒ–3ï¼šç¼“å­˜ä¸ç»­ä¼ 
```javascript
class OrganizeSession {
  async save() {
    await chrome.storage.local.set({
      session: {
        stage: this.currentStage,
        classificationTree: this.classificationTree,
        processedBatches: this.processedBatches,
        timestamp: Date.now()
      }
    });
  }
  
  async resume() {
    const {session} = await chrome.storage.local.get('session');
    if (session && Date.now() - session.timestamp < 3600000) {
      // 1å°æ—¶å†…å¯æ¢å¤
      return session;
    }
    return null;
  }
}
```

è¿™æ ·å³ä½¿ä¸­é€”ä¸­æ–­ï¼Œä¹Ÿèƒ½æ¢å¤è¿›åº¦ã€‚

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

å¯¹äºä½ çš„400+ä¹¦ç­¾ï¼Œæˆ‘æ¨èï¼š

### é…ç½®å»ºè®®
- **é˜¶æ®µ1**ï¼šå‘é€æ‰€æœ‰400ä¸ªä¹¦ç­¾çš„æ‘˜è¦ï¼ˆæ ‡é¢˜+åŸŸåï¼‰ï¼Œè·å–å…¨å±€åˆ†ç±»æ ‘
- **é˜¶æ®µ2**ï¼šåˆ†10-12æ‰¹å¤„ç†ï¼Œæ¯æ‰¹30-40ä¸ª
- **é˜¶æ®µ3**ï¼šå¯é€‰ï¼Œå¦‚æœé˜¶æ®µ2æ•ˆæœå¥½å¯ä»¥è·³è¿‡

### é¢„æœŸæ•ˆæœ
- APIè°ƒç”¨æ¬¡æ•°ï¼š11-13æ¬¡
- æ€»è€—æ—¶ï¼šçº¦5-10åˆ†é’Ÿ
- åˆ†ç±»ç²¾ç¡®åº¦ï¼š>90%
- å±‚çº§ç»“æ„ï¼šå®Œæ•´çš„2-3å±‚

### æˆæœ¬ä¼°ç®—ï¼ˆä»¥OpenAI GPT-4ä¸ºä¾‹ï¼‰
- é˜¶æ®µ1ï¼šçº¦2000 tokensè¾“å…¥ + 1000 tokensè¾“å‡º
- é˜¶æ®µ2ï¼šæ¯æ‰¹çº¦1500 tokensè¾“å…¥ + 800 tokensè¾“å‡º Ã— 12æ‰¹
- æ€»è®¡ï¼šçº¦20,000 tokensè¾“å…¥ + 10,000 tokensè¾“å‡º
- è´¹ç”¨ï¼šçº¦$0.60-0.90ï¼ˆGPT-4ï¼‰ï¼Œ$0.15-0.30ï¼ˆGPT-3.5ï¼‰

---

## ğŸ“Œ å®æ–½æ­¥éª¤

1. **ç«‹å³å¯åš**ï¼šåœ¨AGENT.mdä¸­æ·»åŠ ä¸‰é˜¶æ®µæ•´ç†çš„å®ç°æŒ‡å¯¼
2. **é…ç½®é€‰é¡¹**ï¼šåœ¨UIä¸­è®©ç”¨æˆ·é€‰æ‹©æ•´ç†ç­–ç•¥ï¼ˆå¿«é€Ÿ/ç²¾ç¡®/å¹³è¡¡ï¼‰
3. **è¿›åº¦å±•ç¤º**ï¼šæ¸…æ™°æ˜¾ç¤ºå½“å‰å¤„äºå“ªä¸ªé˜¶æ®µï¼Œè¿›åº¦å¤šå°‘
4. **å¯ä¸­æ–­æ¢å¤**ï¼šæ”¯æŒæš‚åœå’Œæ¢å¤

è¿™ä¸ªæ–¹æ¡ˆå¹³è¡¡äº†ç²¾ç¡®åº¦ã€æˆæœ¬å’Œç”¨æˆ·ä½“éªŒï¼Œæ˜¯ç›®å‰æœ€ä¼˜è§£ã€‚
